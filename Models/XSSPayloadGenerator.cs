using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MicroFocus_Scanner
{
    class XSSPayloadGenerator : IGenPayload
    {
        private string allowedChars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
        static public string atk_must = "<\"\">";
        private string rdn1 = "";
        private string rdn2 = "";
        private int rdn_len = 6;
        private string Payload;

        public XSSPayloadGenerator()
        {
            this.Payload = this.GenerateNewPayload();
        }
        public XSSPayloadGenerator(int l)
        {
            this.rdn_len = l;
            this.Payload = this.GenerateNewPayload();
        }

        public string GenerateNewPayload()
        {
            rdn1 = generate_randString(rdn_len);
            rdn2 = generate_randString(rdn_len);
            string payload = rdn1 + atk_must + rdn2;
            return payload;
        }

        public string GeneratePayload()
        {
            return this.Payload;
        }
        private string generate_randString(int len)
        {
            char[] chars = new char[len];
            Random rng = new Random();
            for (int i = 0; i < len; i++)
            {
                chars[i] = allowedChars[rng.Next(0, allowedChars.Length)];
            }
            return new string(chars);
        }

        //public string GetAttackMust()
        //{
        //    return this.atk_must;
        //}
    }
}
