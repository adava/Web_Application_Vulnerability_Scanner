using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MicroFocus_Scanner
{
    class SQLIPayload : IGenPayload
    {
        private readonly int attack_str_size = 10;
        private readonly char[] pchars_must = { '"', '\'' };
        private readonly char[] pchars_maybe = { ')', '(', ',', '.' };

        public string GeneratePayload()
        {
            char[] chars = new char[attack_str_size];
            Random rng = new Random();
            for (int i = 0; i < this.attack_str_size; i++)
            {
                chars[i] = pchars_maybe[rng.Next(0, pchars_maybe.Length)];
            }
            StringBuilder ret_s = new StringBuilder(new string(chars));
            int m1 = rng.Next(0, attack_str_size);
            int m2 = m1;
            while (m2 == m1)
            {
                m2 = rng.Next(0, attack_str_size);
            }
            ret_s.Insert(m1, pchars_must[0]);
            ret_s.Insert(m1, pchars_must[1]);
            return ret_s.ToString();
        }
    }
}
