using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading.Tasks;

namespace MicroFocus_Scanner
{
    class XSSErrors : IErrorLoader
    {
        private Regex[] regex_pattrs;
        public XSSErrors(string ExpectedPattern)
        {
            string pattern = this.IncludeEscape(ExpectedPattern);
            this.regex_pattrs = new Regex[1];
            //this.regex_pattrs[0] = new Regex("\\\\*<\\\\*\\\\*\"\\\\*\"\\\\*>");
            this.regex_pattrs[0] = new Regex(pattern);

        }
        public Regex[] load_errors()
        {
            return regex_pattrs;
        }
        public string IncludeEscape(string ptr)
        {
            StringBuilder s1 = new StringBuilder();
            for (int i = 0; i < ptr.Length; i++)
            {
                if (XSSPayloadGenerator.atk_must.IndexOf(ptr[i]) >= 0)
                {
                    s1.Append("\\\\?");
                }
                s1.Append(ptr[i]);
            }
            return s1.ToString();
        }

    }
}
